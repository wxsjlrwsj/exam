import{r as m,a as W,q as Z,c as ee,d as x,b as t,$ as te,w as n,e as o,X as ae,n as S,u as ne,i as se,o as v,j as u,t as f,p as $,_ as j}from"./index-DOcvSAvK.js";import{i as le}from"./http-CJ7Q9mKW.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-ngrFHoWO.js";const re={class:"exam-list-container"},ie={class:"pagination-container"},ue={__name:"ExamList",setup(de){const D=ne(),T=se("showMessage"),w=m(!1),h=m("all"),d=m(1),C=m(10),y=m(0),k=m([]),r=W({name:"",status:""}),M={all:null,not_started:"upcoming",in_progress:"ongoing",finished:"finished"},E=s=>s===0?"not_started":s===1?"in_progress":s===2?"finished":"not_started",V=s=>{const e=new Date(s);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`},N=s=>{switch(s){case"not_started":return"info";case"in_progress":return"success";case"finished":return"";default:return""}},U=s=>{switch(s){case"not_started":return"未开始";case"in_progress":return"进行中";case"finished":return"已结束";default:return"未知"}},p=async()=>{w.value=!0;try{const s=M[h.value]||null,_=(await le.get("/api/student/exams",{params:{status:s,page:d.value,size:C.value}}))?.data||{};let i=Array.isArray(_.list)?_.list.map(l=>({id:l.id,name:l.name,subject:l.subject,startTime:l.startTime,endTime:l.endTime,duration:l.duration,status:E(l.status)})):[];r.name&&(i=i.filter(l=>l.name.includes(r.name))),r.status&&(i=i.filter(l=>l.status===r.status)),y.value=Number(_.total)||i.length,k.value=i}catch{k.value=[],y.value=0}finally{w.value=!1}},z=()=>{d.value=1,p()},B=()=>{r.name="",r.status="",z()},L=()=>{d.value=1,p()},P=()=>{p()},R=()=>{d.value=1,p()},F=s=>{D.push(`/student/exam-detail/${s.id}`)},A=s=>{T("进入考试界面","success")},I=s=>{T("查看成绩详情","info")};return Z(()=>{p()}),(s,e)=>{const _=o("el-input"),i=o("el-form-item"),l=o("el-option"),q=o("el-select"),g=o("el-button"),H=o("el-form"),X=o("el-card"),b=o("el-tab-pane"),Y=o("el-tabs"),c=o("el-table-column"),G=o("el-tag"),J=o("el-table"),K=o("el-pagination"),O=ae("loading");return v(),ee("div",re,[e[9]||(e[9]=x("div",{class:"page-header"},[x("h2",{class:"page-title"},"我的考试")],-1)),t(X,{class:"filter-card"},{default:n(()=>[t(H,{inline:!0,model:r,class:"filter-form"},{default:n(()=>[t(i,{label:"考试名称"},{default:n(()=>[t(_,{modelValue:r.name,"onUpdate:modelValue":e[0]||(e[0]=a=>r.name=a),placeholder:"请输入考试名称",clearable:""},null,8,["modelValue"])]),_:1}),t(i,{label:"考试状态"},{default:n(()=>[t(q,{modelValue:r.status,"onUpdate:modelValue":e[1]||(e[1]=a=>r.status=a),placeholder:"请选择考试状态",clearable:""},{default:n(()=>[t(l,{label:"未开始",value:"not_started"}),t(l,{label:"进行中",value:"in_progress"}),t(l,{label:"已结束",value:"finished"})]),_:1},8,["modelValue"])]),_:1}),t(i,null,{default:n(()=>[t(g,{type:"primary",onClick:z},{default:n(()=>[...e[5]||(e[5]=[u("查询",-1)])]),_:1}),t(g,{onClick:B},{default:n(()=>[...e[6]||(e[6]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(Y,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=a=>h.value=a),onTabClick:L},{default:n(()=>[t(b,{label:"全部考试",name:"all"}),t(b,{label:"未开始",name:"not_started"}),t(b,{label:"进行中",name:"in_progress"}),t(b,{label:"已结束",name:"finished"})]),_:1},8,["modelValue"]),te((v(),S(J,{data:k.value,border:"",style:{width:"100%"},onRowClick:F},{default:n(()=>[t(c,{prop:"name",label:"考试名称","min-width":"180"}),t(c,{label:"科目","min-width":"120"},{default:n(a=>[u(f(a.row.subject||"-"),1)]),_:1}),t(c,{label:"考试时间","min-width":"240"},{default:n(a=>[u(f(V(a.row.startTime))+" 至 "+f(V(a.row.endTime)),1)]),_:1}),t(c,{prop:"duration",label:"考试时长","min-width":"100"},{default:n(a=>[u(f(a.row.duration)+" 分钟 ",1)]),_:1}),t(c,{prop:"status",label:"状态","min-width":"100"},{default:n(a=>[t(G,{type:N(a.row.status)},{default:n(()=>[u(f(U(a.row.status)),1)]),_:2},1032,["type"])]),_:1}),t(c,{label:"操作",fixed:"right",width:"200"},{default:n(a=>[a.row.status==="in_progress"?(v(),S(g,{key:0,link:"",type:"success",onClick:j(Q=>A(a.row),["stop"])},{default:n(()=>[...e[7]||(e[7]=[u(" 参加考试 ",-1)])]),_:1},8,["onClick"])):$("",!0),a.row.status==="finished"?(v(),S(g,{key:1,link:"",type:"primary",onClick:j(Q=>I(a.row),["stop"])},{default:n(()=>[...e[8]||(e[8]=[u(" 查看成绩 ",-1)])]),_:1},8,["onClick"])):$("",!0)]),_:1})]),_:1},8,["data"])),[[O,w.value]]),x("div",ie,[t(K,{"current-page":d.value,"onUpdate:currentPage":e[3]||(e[3]=a=>d.value=a),"page-size":C.value,"onUpdate:pageSize":e[4]||(e[4]=a=>C.value=a),"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:y.value,onSizeChange:R,onCurrentChange:P},null,8,["current-page","page-size","total"])])])}}},fe=oe(ue,[["__scopeId","data-v-8b51880a"]]);export{fe as default};
