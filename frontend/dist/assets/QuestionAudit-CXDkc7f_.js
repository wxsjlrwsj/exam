import{r as _,a as P,q as Z,c as S,d as o,b as e,w as l,e as u,X as ee,o as g,h as te,j as i,f as U,V as le,U as ae,$ as E,n as I,t as p,E as oe,a8 as ne,p as se,F as ue,P as ie,a2 as de}from"./index-DOcvSAvK.js";import{s as j}from"./request-3uTHAmsp.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-ngrFHoWO.js";const pe={class:"page-container"},me={class:"pagination-container"},_e={class:"question-preview"},fe={class:"q-header"},ce={class:"q-type"},ve={class:"q-diff"},ge=["innerHTML"],be={key:0,class:"q-options"},we={class:"q-answer"},ye={class:"dialog-footer"},Ve={class:"question-preview"},he={class:"q-header"},Ne={class:"q-type"},qe={class:"q-diff"},Ce=["innerHTML"],xe={class:"q-answer"},ke={class:"audit-info"},Te={__name:"QuestionAudit",setup(Se){const h=_(!1),N=_([]),z=_(0),q=_("pending"),C=_(!1),L=_(!1),n=_({}),b=P({comment:""}),s=P({pageNum:1,pageSize:10,submitterName:"",status:void 0}),x=d=>({single:"单选题",multiple:"多选题",judge:"判断题",short_answer:"简答题"})[d]||d,w=async()=>{h.value=!0;try{let d=s.status;q.value==="pending"&&(d=0);const t={pageNum:s.pageNum,pageSize:s.pageSize,submitterName:s.submitterName,status:d};q.value==="pending"?t.status=0:t.status;const y=await j.get("/audit/question/list",{params:t}),f=y.data?.list||[],V=y.data?.total||0;N.value=f.map(m=>({...m,contentFormatted:m.content,contentSummary:(m.content||"").length>50?(m.content||"").substring(0,50)+"...":m.content})),z.value=V}catch{N.value=[],z.value=0}finally{h.value=!1}},K=()=>{s.pageNum=1,s.status=void 0,w()},D=()=>{s.pageNum=1,w()},R=()=>{s.submitterName="",s.status=void 0,D()},X=d=>{n.value={...d},b.comment="",C.value=!0},G=d=>{n.value={...d},L.value=!0},F=async d=>{try{await j.put("/audit/question/process",{ids:[n.value.id],status:d,comment:b.comment}),de.success(d===1?"已通过":"已驳回"),C.value=!1,w()}catch{}};return Z(()=>{w()}),(d,t)=>{const y=u("el-input"),f=u("el-form-item"),V=u("el-option"),m=u("el-select"),k=u("el-icon"),c=u("el-button"),M=u("el-form"),Q=u("el-card"),r=u("el-table-column"),T=u("el-tag"),J=u("el-rate"),$=u("el-table"),A=u("el-tab-pane"),O=u("el-tabs"),W=u("el-pagination"),B=u("el-dialog"),Y=u("el-divider"),H=ee("loading");return g(),S("div",pe,[t[23]||(t[23]=o("div",{class:"header"},[o("h2",null,"题目上传申请审核")],-1)),e(Q,{class:"search-card"},{default:l(()=>[e(M,{model:s,ref:"queryRef",inline:!0,"label-width":"68px"},{default:l(()=>[e(f,{label:"提交人员",prop:"submitterName"},{default:l(()=>[e(y,{modelValue:s.submitterName,"onUpdate:modelValue":t[0]||(t[0]=a=>s.submitterName=a),placeholder:"请输入提交人姓名",clearable:"",style:{width:"200px"},onKeyup:te(D,["enter"])},null,8,["modelValue"])]),_:1}),e(f,{label:"审核状态",prop:"status"},{default:l(()=>[e(m,{modelValue:s.status,"onUpdate:modelValue":t[1]||(t[1]=a=>s.status=a),placeholder:"全部",clearable:"",style:{width:"200px"}},{default:l(()=>[e(V,{label:"待审核",value:0}),e(V,{label:"审核通过",value:1}),e(V,{label:"驳回",value:2})]),_:1},8,["modelValue"])]),_:1}),e(f,null,{default:l(()=>[e(c,{type:"primary",onClick:D},{default:l(()=>[e(k,null,{default:l(()=>[e(U(le))]),_:1}),t[10]||(t[10]=i(" 搜索 ",-1))]),_:1}),e(c,{onClick:R},{default:l(()=>[e(k,null,{default:l(()=>[e(U(ae))]),_:1}),t[11]||(t[11]=i(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Q,{class:"table-card"},{default:l(()=>[e(O,{modelValue:q.value,"onUpdate:modelValue":t[2]||(t[2]=a=>q.value=a),onTabChange:K},{default:l(()=>[e(A,{label:"待审核",name:"pending"},{default:l(()=>[E((g(),I($,{data:N.value,style:{width:"100%"}},{default:l(()=>[e(r,{prop:"id",label:"ID",width:"80"}),e(r,{prop:"type",label:"题型",width:"100"},{default:l(a=>[e(T,null,{default:l(()=>[i(p(x(a.row.type)),1)]),_:2},1024)]),_:1}),e(r,{prop:"contentSummary",label:"题目内容摘要","min-width":"300","show-overflow-tooltip":!0}),e(r,{prop:"difficulty",label:"难度",width:"80"},{default:l(a=>[e(J,{modelValue:a.row.difficulty,"onUpdate:modelValue":v=>a.row.difficulty=v,disabled:"","text-color":"#ff9900"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(r,{prop:"submitterName",label:"提交人",width:"120"}),e(r,{prop:"submitTime",label:"提交时间",width:"180"}),e(r,{label:"操作",width:"200",fixed:"right"},{default:l(a=>[e(c,{type:"primary",link:"",onClick:v=>X(a.row)},{default:l(()=>[e(k,null,{default:l(()=>[e(U(oe))]),_:1}),t[12]||(t[12]=i(" 审核 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,h.value]])]),_:1}),e(A,{label:"已审核",name:"processed"},{default:l(()=>[E((g(),I($,{data:N.value,style:{width:"100%"}},{default:l(()=>[e(r,{prop:"id",label:"ID",width:"80"}),e(r,{prop:"type",label:"题型",width:"100"},{default:l(a=>[e(T,null,{default:l(()=>[i(p(x(a.row.type)),1)]),_:2},1024)]),_:1}),e(r,{prop:"contentSummary",label:"题目内容摘要","min-width":"300","show-overflow-tooltip":!0}),e(r,{prop:"status",label:"状态",width:"100"},{default:l(a=>[e(T,{type:a.row.status===1?"success":"danger"},{default:l(()=>[i(p(a.row.status===1?"通过":"驳回"),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"submitterName",label:"提交人",width:"120"}),e(r,{prop:"auditTime",label:"审核时间",width:"180"}),e(r,{prop:"auditorName",label:"审核人",width:"120"}),e(r,{label:"操作",width:"120",fixed:"right"},{default:l(a=>[e(c,{type:"primary",link:"",onClick:v=>G(a.row)},{default:l(()=>[e(k,null,{default:l(()=>[e(U(ne))]),_:1}),t[13]||(t[13]=i(" 详情 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,h.value]])]),_:1})]),_:1},8,["modelValue"]),o("div",me,[e(W,{"current-page":s.pageNum,"onUpdate:currentPage":t[3]||(t[3]=a=>s.pageNum=a),"page-size":s.pageSize,"onUpdate:pageSize":t[4]||(t[4]=a=>s.pageSize=a),total:z.value,layout:"total, prev, pager, next",onCurrentChange:w},null,8,["current-page","page-size","total"])])]),_:1}),e(B,{modelValue:C.value,"onUpdate:modelValue":t[8]||(t[8]=a=>C.value=a),title:"题目审核",width:"600px"},{footer:l(()=>[o("span",ye,[e(c,{type:"danger",onClick:t[6]||(t[6]=a=>F(2))},{default:l(()=>[...t[15]||(t[15]=[i("驳回",-1)])]),_:1}),e(c,{type:"success",onClick:t[7]||(t[7]=a=>F(1))},{default:l(()=>[...t[16]||(t[16]=[i("通过",-1)])]),_:1})])]),default:l(()=>[o("div",_e,[o("div",fe,[o("span",ce,"["+p(x(n.value.type))+"]",1),o("span",ve,"难度: "+p(n.value.difficulty),1)]),o("div",{class:"q-content",innerHTML:n.value.contentFormatted},null,8,ge),n.value.options?(g(),S("div",be,[(g(!0),S(ue,null,ie(n.value.options,(a,v)=>(g(),S("div",{key:v,class:"q-option"},p(String.fromCharCode(65+v))+". "+p(a),1))),128))])):se("",!0),o("div",we,[t[14]||(t[14]=o("strong",null,"参考答案:",-1)),i(" "+p(n.value.answer),1)])]),e(M,{model:b,"label-width":"80px",style:{"margin-top":"20px"}},{default:l(()=>[e(f,{label:"审核意见"},{default:l(()=>[e(y,{modelValue:b.comment,"onUpdate:modelValue":t[5]||(t[5]=a=>b.comment=a),type:"textarea",placeholder:"请输入审核意见（选填）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(B,{modelValue:L.value,"onUpdate:modelValue":t[9]||(t[9]=a=>L.value=a),title:"审核详情",width:"600px"},{default:l(()=>[o("div",Ve,[o("div",he,[o("span",Ne,"["+p(x(n.value.type))+"]",1),o("span",qe,"难度: "+p(n.value.difficulty),1)]),o("div",{class:"q-content",innerHTML:n.value.contentFormatted},null,8,Ce),o("div",xe,[t[17]||(t[17]=o("strong",null,"参考答案:",-1)),i(" "+p(n.value.answer),1)]),e(Y),o("div",ke,[o("p",null,[t[18]||(t[18]=o("strong",null,"审核结果:",-1)),t[19]||(t[19]=i()),e(T,{type:n.value.status===1?"success":"danger"},{default:l(()=>[i(p(n.value.status===1?"通过":"驳回"),1)]),_:1},8,["type"])]),o("p",null,[t[20]||(t[20]=o("strong",null,"审核意见:",-1)),i(" "+p(n.value.auditComment||"无"),1)]),o("p",null,[t[21]||(t[21]=o("strong",null,"审核人:",-1)),i(" "+p(n.value.auditorName),1)]),o("p",null,[t[22]||(t[22]=o("strong",null,"审核时间:",-1)),i(" "+p(n.value.auditTime),1)])])])]),_:1},8,["modelValue"])])}}},Fe=re(Te,[["__scopeId","data-v-7a3855da"]]);export{Fe as default};
