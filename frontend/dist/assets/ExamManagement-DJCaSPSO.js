import{r as i,q as Z,c as ee,d as p,b as t,w as a,e as u,u as B,i as y,X as te,o as C,j as r,f as P,S as ae,$ as ne,aa as oe,ab as se,n as V,t as le,p as N}from"./index-DOcvSAvK.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"exam-management-container"},re={class:"tab-content"},de={class:"action-bar"},ce={class:"tab-content"},pe={class:"action-bar"},me={class:"pagination-container"},ge={__name:"ExamManagement",setup(fe){B();const m=y("showMessage"),U=y("showConfirm"),b=i("exam"),$=i("upcoming"),w=i([]),x={props:{status:{type:String,required:!0},data:{type:Array,required:!0}},emits:["refresh"],setup(o,{emit:e}){const f=B(),s=y("showMessage"),d=y("showConfirm");return{getStatusType:l=>({upcoming:"info",ongoing:"success",finished:"warning"})[l]||"",getStatusText:l=>({upcoming:"未开始",ongoing:"进行中",finished:"已结束"})[l]||"未知",handleViewDetail:l=>s(`查看考试详情: ${l.id}`,"info"),handleManageStudents:l=>s("管理考生功能待实现","info"),handleProctor:l=>s("在线监考功能待实现","info"),handleGrade:l=>f.push("/teacher/score-management"),handleViewResults:l=>f.push("/teacher/score-management"),handleDelete:l=>{d(`确定要删除考试"${l.name}"吗？`,"删除确认","warning").then(()=>{setTimeout(()=>{s("删除成功","success"),e("refresh")},500)}).catch(()=>{})}}},template:`
    <el-table :data="data.filter(item => item.status === status)" border style="width: 100%">
      <el-table-column prop="name" label="考试名称" min-width="180" />
      <el-table-column prop="subject" label="科目" width="120" />
      <el-table-column prop="startTime" label="开始时间" width="180" />
      <el-table-column prop="duration" label="考试时长" width="100">
        <template #default="scope">{{ scope.row.duration }}分钟</template>
      </el-table-column>
      <el-table-column prop="status" label="状态" width="100">
        <template #default="scope">
          <el-tag :type="getStatusType(scope.row.status)">{{ getStatusText(scope.row.status) }}</el-tag>
        </template>
      </el-table-column>
      <el-table-column label="操作" width="300" fixed="right">
        <template #default="scope">
          <el-button link type="primary" @click="handleViewDetail(scope.row)">详情</el-button>
          <el-button link type="primary" @click="handleManageStudents(scope.row)">考生</el-button>
          <el-button link type="success" @click="handleProctor(scope.row)" v-if="scope.row.status === 'ongoing'">监考</el-button>
          <el-button link type="warning" @click="handleGrade(scope.row)" v-if="scope.row.status === 'finished'">批阅</el-button>
          <el-button link type="info" @click="handleViewResults(scope.row)" v-if="scope.row.status === 'finished'">成绩</el-button>
          <el-button link type="danger" @click="handleDelete(scope.row)" v-if="scope.row.status === 'upcoming'">删除</el-button>
        </template>
      </el-table-column>
    </el-table>
  `},G=[{id:1,name:"Java程序设计期中考试",subject:"Java",startTime:"2023-11-15 14:30:00",duration:120,status:"upcoming"},{id:2,name:"数据结构期末考试",subject:"数据结构",startTime:"2023-11-10 09:00:00",duration:150,status:"ongoing"},{id:3,name:"计算机网络模拟考试",subject:"计算机网络",startTime:"2023-10-20 16:00:00",duration:90,status:"finished"}],g=()=>{setTimeout(()=>{w.value=G},500)},I=()=>g(),J=()=>{b.value="paper",m("请先选择或创建试卷，然后发布考试","info")},T=i(!1),h=i(1),v=i(10),D=i(0),M=i([]),E=[{id:1,name:"Java程序设计期中试卷",questionCount:25,totalScore:100,createTime:"2023-10-15 14:30:22",status:"unused"},{id:2,name:"数据结构期末试卷",questionCount:30,totalScore:100,createTime:"2023-10-18 09:45:36",status:"used"},{id:3,name:"计算机网络模拟试卷",questionCount:28,totalScore:100,createTime:"2023-10-20 16:22:15",status:"unused"}],A=o=>o==="used"?"success":"info",X=o=>o==="used"?"已使用":"未使用",_=()=>{T.value=!0,setTimeout(()=>{D.value=E.length;const o=(h.value-1)*v.value,e=o+v.value;M.value=E.slice(o,e),T.value=!1},500)},F=()=>_(),H=()=>{h.value=1,_()},z=o=>m(`${o==="manual"?"手动":"智能"}组卷功能待实现`,"info"),K=o=>m(`预览试卷ID: ${o.id}`,"info"),O=o=>m(`编辑试卷ID: ${o.id}`,"info"),Q=o=>{m(`发布考试: ${o.name}`,"success"),b.value="exam",g()},W=o=>{U(`确定要删除试卷"${o.name}"吗？`,"删除确认","warning").then(()=>{setTimeout(()=>{m("删除成功","success"),_()},500)}).catch(()=>{})};return Z(()=>{g(),_()}),(o,e)=>{const f=u("el-icon"),s=u("el-button"),d=u("el-tab-pane"),S=u("el-tabs"),c=u("el-table-column"),j=u("el-tag"),q=u("el-table"),R=u("el-pagination"),L=te("loading");return C(),ee("div",ue,[e[13]||(e[13]=p("div",{class:"page-header"},[p("h2",{class:"page-title"},"考试管理")],-1)),t(S,{modelValue:b.value,"onUpdate:modelValue":e[5]||(e[5]=n=>b.value=n),type:"card",class:"module-tabs"},{default:a(()=>[t(d,{label:"考试列表",name:"exam"},{default:a(()=>[p("div",re,[p("div",de,[t(s,{type:"primary",onClick:J},{default:a(()=>[t(f,null,{default:a(()=>[t(P(ae))]),_:1}),e[6]||(e[6]=r("创建考试 ",-1))]),_:1})]),t(S,{modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=n=>$.value=n),onTabClick:I},{default:a(()=>[t(d,{label:"未开始",name:"upcoming"},{default:a(()=>[t(x,{status:"upcoming",data:w.value,onRefresh:g},null,8,["data"])]),_:1}),t(d,{label:"进行中",name:"ongoing"},{default:a(()=>[t(x,{status:"ongoing",data:w.value,onRefresh:g},null,8,["data"])]),_:1}),t(d,{label:"已结束",name:"finished"},{default:a(()=>[t(x,{status:"finished",data:w.value,onRefresh:g},null,8,["data"])]),_:1})]),_:1},8,["modelValue"])])]),_:1}),t(d,{label:"试卷管理",name:"paper"},{default:a(()=>[p("div",ce,[p("div",pe,[t(s,{type:"primary",onClick:e[1]||(e[1]=n=>z("manual"))},{default:a(()=>[t(f,null,{default:a(()=>[t(P(oe))]),_:1}),e[7]||(e[7]=r("手动组卷 ",-1))]),_:1}),t(s,{type:"success",onClick:e[2]||(e[2]=n=>z("auto"))},{default:a(()=>[t(f,null,{default:a(()=>[t(P(se))]),_:1}),e[8]||(e[8]=r("智能组卷 ",-1))]),_:1})]),ne((C(),V(q,{data:M.value,border:"",style:{width:"100%"}},{default:a(()=>[t(c,{prop:"name",label:"试卷名称","min-width":"180"}),t(c,{prop:"questionCount",label:"题目数量",width:"100"}),t(c,{prop:"totalScore",label:"总分",width:"80"}),t(c,{prop:"createTime",label:"创建时间",width:"180"}),t(c,{prop:"status",label:"状态",width:"100"},{default:a(n=>[t(j,{type:A(n.row.status)},{default:a(()=>[r(le(X(n.row.status)),1)]),_:2},1032,["type"])]),_:1}),t(c,{label:"操作",width:"280",fixed:"right"},{default:a(n=>[t(s,{link:"",type:"primary",onClick:k=>K(n.row)},{default:a(()=>[...e[9]||(e[9]=[r("预览",-1)])]),_:1},8,["onClick"]),n.row.status!=="used"?(C(),V(s,{key:0,link:"",type:"primary",onClick:k=>O(n.row)},{default:a(()=>[...e[10]||(e[10]=[r("编辑",-1)])]),_:1},8,["onClick"])):N("",!0),t(s,{link:"",type:"success",onClick:k=>Q(n.row)},{default:a(()=>[...e[11]||(e[11]=[r("发布考试",-1)])]),_:1},8,["onClick"]),n.row.status!=="used"?(C(),V(s,{key:1,link:"",type:"danger",onClick:k=>W(n.row)},{default:a(()=>[...e[12]||(e[12]=[r("删除",-1)])]),_:1},8,["onClick"])):N("",!0)]),_:1})]),_:1},8,["data"])),[[L,T.value]]),p("div",me,[t(R,{"current-page":h.value,"onUpdate:currentPage":e[3]||(e[3]=n=>h.value=n),"page-size":v.value,"onUpdate:pageSize":e[4]||(e[4]=n=>v.value=n),"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:D.value,onSizeChange:H,onCurrentChange:F},null,8,["current-page","page-size","total"])])])]),_:1})]),_:1},8,["modelValue"])])}}},he=ie(ge,[["__scopeId","data-v-83c3c6e2"]]);export{he as default};
