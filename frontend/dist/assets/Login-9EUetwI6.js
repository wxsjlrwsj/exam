import{r as y,a as h,c as b,b as s,d as a,w as n,e as m,t as x,u as I,i as V,o as S,f as d,g as T,h as C,l as D,j as f}from"./index-DOcvSAvK.js";import{_ as F}from"./logo-y3WsqpWF.js";import{s as B}from"./request-3uTHAmsp.js";import{P as L}from"./ParticlesBackground-DjYnQhPs.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-ngrFHoWO.js";const N={class:"login-container"},j={class:"login-box"},q={class:"extra-actions"},z={class:"login-footer"},E={__name:"Login",setup(H){const u=I(),g=V("showMessage"),p=y(!1),o=h({username:"",password:""}),k={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},_=async()=>{c.value&&await c.value.validate(async w=>{if(w){p.value=!0;try{const t=(await B.post("/auth/login",{username:o.username,password:o.password})).data||{},l=t.token,r=t.userInfo||{};if(!l||!r.userType)throw new Error("登录响应不完整");localStorage.setItem("token",l),localStorage.setItem("userType",r.userType),localStorage.setItem("username",r.username||o.username),g("登录成功，欢迎回来！","success"),u.push({name:"DashboardHome"})}catch{if(localStorage.getItem("useFakeAuth")==="1"){let t="student";o.username.includes("admin")?t="admin":o.username.includes("teacher")&&(t="teacher"),localStorage.setItem("token","mock-token-"+Date.now()),localStorage.setItem("userType",t),localStorage.setItem("username",o.username),g("登录成功（测试账号）","success"),u.push({name:"DashboardHome"})}}finally{p.value=!1}}})},c=y(null);return(w,e)=>{const t=m("el-input"),l=m("el-form-item"),r=m("el-button"),v=m("el-form");return S(),b("div",N,[s(L,{color:"rgba(255, 255, 255, 0.6)",count:100}),a("div",j,[e[7]||(e[7]=a("div",{class:"login-header"},[a("img",{src:F,alt:"Logo",class:"logo"}),a("h1",{class:"title"},"超星考试系统"),a("p",{class:"subtitle"},"智慧教学管理平台")],-1)),s(v,{ref_key:"loginFormRef",ref:c,model:o,rules:k,class:"login-form"},{default:n(()=>[s(l,{prop:"username"},{default:n(()=>[s(t,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=i=>o.username=i),placeholder:"用户名 (admin/teacher/student)","prefix-icon":d(T),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),s(l,{prop:"password"},{default:n(()=>[s(t,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=i=>o.password=i),type:"password",placeholder:"密码","prefix-icon":d(D),size:"large",onKeyup:C(_,["enter"])},null,8,["modelValue","prefix-icon"])]),_:1}),s(l,null,{default:n(()=>[s(r,{type:"primary",loading:p.value,onClick:_,class:"login-button"},{default:n(()=>[...e[4]||(e[4]=[f("登录",-1)])]),_:1},8,["loading"])]),_:1}),a("div",q,[s(r,{link:"",type:"info",onClick:e[2]||(e[2]=i=>d(u).push("/forgot-password"))},{default:n(()=>[...e[5]||(e[5]=[f("忘记密码？",-1)])]),_:1}),s(r,{link:"",type:"primary",onClick:e[3]||(e[3]=i=>d(u).push("/register"))},{default:n(()=>[...e[6]||(e[6]=[f("注册新账号",-1)])]),_:1})])]),_:1},8,["model"]),a("div",z,[a("p",null,"© "+x(new Date().getFullYear())+" 超星考试系统 版权所有",1)])])])}}},Y=R(E,[["__scopeId","data-v-dff48719"]]);export{Y as default};
